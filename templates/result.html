<!DOCTYPE html>
<html lang="en" data-theme="neon">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#00f2ff">
    <title>QuizVerse - Results</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body{
            font-family:'Orbitron',sans-serif;
            background:radial-gradient(circle at top,#020024,#090979,#00d4ff);
            color:#fff;
            min-height:100vh;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }
        body.light-theme{
            background:radial-gradient(circle at top,#87CEEB,#98D8C8,#F0E68C);
            color:#333;
        }
        .result-container{
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .result-container::before{
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(0,242,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer{
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }
        .score-display{
            position: relative;
            z-index: 1;
        }
        .score-circle{
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00f2ff, #0099cc);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            position: relative;
            box-shadow: 0 15px 35px rgba(0,242,255,0.3);
            animation: pulse 2s infinite;
        }
        @keyframes pulse{
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .score-circle.excellent{
            background: linear-gradient(135deg, #FFD700, #FFA500);
            box-shadow: 0 15px 35px rgba(255,215,0,0.3);
        }
        .score-circle.good{
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            box-shadow: 0 15px 35px rgba(76,175,80,0.3);
        }
        .score-circle.average{
            background: linear-gradient(135deg, #ff9800, #f57c00);
            box-shadow: 0 15px 35px rgba(255,152,0,0.3);
        }
        .score-circle.poor{
            background: linear-gradient(135deg, #f44336, #c62828);
            box-shadow: 0 15px 35px rgba(244,67,54,0.3);
        }
        .score-text{
            font-size: 48px;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .score-label{
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }
        .stats-grid{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card{
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .stat-card:hover{
            transform: translateY(-5px);
            background: rgba(255,255,255,0.1);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        .stat-icon{
            font-size: 24px;
            margin-bottom: 10px;
            display: block;
        }
        .stat-value{
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }
        .stat-label{
            font-size: 12px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .achievement-section{
            margin: 30px 0;
        }
        .achievement-grid{
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .achievement-badge{
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .achievement-badge.unlocked{
            background: linear-gradient(135deg, #FFD700, #FFA500);
            box-shadow: 0 5px 15px rgba(255,215,0,0.3);
            animation: unlock 0.5s ease;
        }
        .achievement-badge.locked{
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            opacity: 0.5;
        }
        @keyframes unlock{
            0% { transform: scale(0) rotate(0deg); }
            50% { transform: scale(1.2) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }
        .progress-ring{
            width: 120px;
            height: 120px;
            margin: 20px auto;
        }
        .progress-ring-circle{
            transition: stroke-dashoffset 1s ease;
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        .action-buttons{
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        .action-btn{
            padding: 12px 30px;
            border-radius: 25px;
            border: none;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .action-btn::before{
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }
        .action-btn:hover::before{
            width: 300px;
            height: 300px;
        }
        .btn-primary-custom{
            background: linear-gradient(135deg, #00f2ff, #0099cc);
            color: white;
        }
        .btn-success-custom{
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
        }
        .btn-warning-custom{
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #333;
        }
        .confetti{
            position: fixed;
            width: 10px;
            height: 10px;
            background: #00f2ff;
            position: absolute;
            animation: confetti-fall 3s linear infinite;
        }
        @keyframes confetti-fall{
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        .theme-toggle{
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .theme-toggle:hover{
            background: rgba(255,255,255,0.3);
            transform: rotate(180deg);
        }
        .leaderboard-section{
            margin: 30px 0;
        }
        .leaderboard-table{
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            overflow: hidden;
        }
        .leaderboard-table th{
            background: rgba(0,242,255,0.2);
            border: none;
            padding: 15px;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 12px;
            letter-spacing: 1px;
        }
        .leaderboard-table td{
            padding: 12px 15px;
            border: none;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .rank-medal{
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 10px;
        }
        .rank-1{ background: linear-gradient(135deg, #FFD700, #FFA500); color: #333; }
        .rank-2{ background: linear-gradient(135deg, #C0C0C0, #808080); color: #333; }
        .rank-3{ background: linear-gradient(135deg, #CD7F32, #8B4513); color: white; }
        .share-section{
            margin: 30px 0;
            text-align: center;
        }
        .share-buttons{
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        .share-btn{
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .share-btn:hover{
            transform: scale(1.1);
            background: rgba(255,255,255,0.2);
        }
        .performance-chart{
            margin: 30px 0;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
        }
        .chart-bar{
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .chart-label{
            width: 100px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .chart-progress{
            flex: 1;
            height: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 0 10px;
        }
        .chart-fill{
            height: 100%;
            border-radius: 10px;
            transition: width 1s ease;
        }
        .chart-value{
            width: 50px;
            text-align: right;
            font-weight: 600;
        }
    </style>
</head>

<body>

<!-- Theme Toggle -->
<div class="theme-toggle" onclick="toggleTheme()" title="Toggle Theme">
    <i class="bi bi-moon-fill" id="themeIcon"></i>
</div>

<!-- Confetti Container -->
<div id="confettiContainer"></div>

<!-- Main Container -->
<div class="container py-5">
    <div class="result-container p-5">
        
        <!-- Header -->
        <div class="text-center mb-5">
            <h1 class="display-4 fw-bold mb-3">
                <i class="bi bi-trophy-fill text-warning"></i> Quiz Results
            </h1>
            <p class="lead opacity-75">Here's how you performed!</p>
        </div>

        <!-- Score Display -->
        <div class="score-display text-center">
            <div class="score-circle" id="scoreCircle">
                <div>
                    <div class="score-text" id="scoreText">0%</div>
                    <div class="score-label">ACCURACY</div>
                </div>
            </div>
            
            <h2 class="mb-3" id="performanceTitle">Good Job!</h2>
            <p class="lead mb-4" id="performanceMessage">You did well! Keep practicing to improve.</p>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-icon">‚úÖ</span>
                <div class="stat-value" id="correctCount">0</div>
                <div class="stat-label">Correct</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">‚ùå</span>
                <div class="stat-value" id="wrongCount">0</div>
                <div class="stat-label">Wrong</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">‚è±Ô∏è</span>
                <div class="stat-value" id="timeTaken">0s</div>
                <div class="stat-label">Time</div>
            </div>
            <div class="stat-card">
                <span class="stat-icon">üî•</span>
                <div class="stat-value" id="streakCount">0</div>
                <div class="stat-label">Best Streak</div>
            </div>
        </div>

        <!-- Performance Chart -->
        <div class="performance-chart">
            <h4 class="mb-3">Performance Breakdown</h4>
            <div class="chart-bar">
                <div class="chart-label">Accuracy</div>
                <div class="chart-progress">
                    <div class="chart-fill bg-success" id="accuracyBar" style="width: 0%"></div>
                </div>
                <div class="chart-value" id="accuracyValue">0%</div>
            </div>
            <div class="chart-bar">
                <div class="chart-label">Speed</div>
                <div class="chart-progress">
                    <div class="chart-fill bg-info" id="speedBar" style="width: 0%"></div>
                </div>
                <div class="chart-value" id="speedValue">0%</div>
            </div>
            <div class="chart-bar">
                <div class="chart-label">Consistency</div>
                <div class="chart-progress">
                    <div class="chart-fill bg-warning" id="consistencyBar" style="width: 0%"></div>
                </div>
                <div class="chart-value" id="consistencyValue">0%</div>
            </div>
        </div>

        <!-- Achievements Section -->
        <div class="achievement-section">
            <h4 class="text-center mb-3">Achievements Unlocked</h4>
            <div class="achievement-grid" id="achievementGrid">
                <!-- Achievements will be dynamically added here -->
            </div>
        </div>

        <!-- Leaderboard Section -->
        <div class="leaderboard-section">
            <h4 class="text-center mb-3">Top Scores</h4>
            <div class="leaderboard-table">
                <table class="table table-dark table-hover">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Player</th>
                            <th>Score</th>
                            <th>Accuracy</th>
                            <th>Time</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody">
                        <!-- Leaderboard entries will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Share Section -->
        <div class="share-section">
            <h4>Share Your Results</h4>
            <div class="share-buttons">
                <a href="#" class="share-btn" onclick="shareOnTwitter()" title="Share on Twitter">
                    <i class="bi bi-twitter"></i>
                </a>
                <a href="#" class="share-btn" onclick="shareOnFacebook()" title="Share on Facebook">
                    <i class="bi bi-facebook"></i>
                </a>
                <a href="#" class="share-btn" onclick="copyLink()" title="Copy Link">
                    <i class="bi bi-link-45deg"></i>
                </a>
                <a href="#" class="share-btn" onclick="downloadResults()" title="Download Results">
                    <i class="bi bi-download"></i>
                </a>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="action-btn btn-success-custom" onclick="downloadCertificate()">
                <i class="bi bi-award-fill"></i> Download Certificate
            </button>
            <button class="action-btn btn-primary-custom" onclick="reviewAnswers()">
                <i class="bi bi-eye-fill"></i> Review Answers
            </button>
            <button class="action-btn btn-warning-custom" onclick="playAgain()">
                <i class="bi bi-arrow-clockwise"></i> Play Again
            </button>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// Game Results Data
let results = {
    score: 0,
    total: 0,
    correct: 0,
    wrong: 0,
    time: 0,
    accuracy: 0,
    difficulty: 'easy',
    username: 'Player',
    streak: 0,
    category: 'Mixed'
};

// Achievements Data
const achievements = [
    { id: 'perfect', icon: 'üèÜ', name: 'Perfect Score', condition: (r) => r.accuracy === 100 },
    { id: 'excellent', icon: '‚≠ê', name: 'Excellent', condition: (r) => r.accuracy >= 90 },
    { id: 'good', icon: 'üëç', name: 'Good Job', condition: (r) => r.accuracy >= 70 },
    { id: 'fast', icon: '‚ö°', name: 'Speed Demon', condition: (r) => r.time < 30 },
    { id: 'streak', icon: 'üî•', name: 'On Fire', condition: (r) => r.streak >= 5 },
    { id: 'first', icon: 'üéØ', name: 'First Try', condition: (r) => r.total === r.correct },
    { id: 'survivor', icon: 'üí™', name: 'Survivor', condition: (r) => r.lives > 0 },
    { id: 'persistent', icon: 'üöÄ', name: 'Persistent', condition: (r) => r.total >= 10 }
];

// Initialize
window.onload = () => {
    loadResults();
    calculateMetrics();
    displayResults();
    checkAchievements();
    loadLeaderboard();
    createConfetti();
    loadTheme();
    animateCharts();
};

function loadResults() {
    // Get results from URL parameters or localStorage
    const urlParams = new URLSearchParams(window.location.search);
    const savedResults = localStorage.getItem('lastQuizResults');
    
    if (urlParams.has('score') && urlParams.has('total')) {
        results.score = parseInt(urlParams.get('score')) || 0;
        results.total = parseInt(urlParams.get('total')) || 10;
        results.time = parseInt(urlParams.get('time')) || 0;
        results.difficulty = urlParams.get('difficulty') || 'easy';
        results.username = urlParams.get('username') || 'Player';
    } else if (savedResults) {
        const data = JSON.parse(savedResults);
        results = { ...results, ...data };
    } else {
        // Default results for demo
        results = {
            score: 8,
            total: 10,
            correct: 8,
            wrong: 2,
            time: 45,
            accuracy: 80,
            difficulty: 'medium',
            username: 'Player',
            streak: 3,
            category: 'Mixed'
        };
    }
    
    results.correct = results.score;
    results.wrong = results.total - results.score;
    results.accuracy = Math.round((results.correct / results.total) * 100);
}

function calculateMetrics() {
    // Calculate additional metrics
    const avgTimePerQuestion = results.time / results.total;
    const speedScore = Math.max(0, 100 - (avgTimePerQuestion * 2));
    const consistencyScore = results.streak > 0 ? Math.min(100, (results.streak / results.correct) * 100) : 0;
    
    results.speedScore = Math.round(speedScore);
    results.consistencyScore = Math.round(consistencyScore);
    results.avgTimePerQuestion = Math.round(avgTimePerQuestion);
}

function displayResults() {
    // Update score display
    const scoreCircle = document.getElementById('scoreCircle');
    const scoreText = document.getElementById('scoreText');
    const performanceTitle = document.getElementById('performanceTitle');
    const performanceMessage = document.getElementById('performanceMessage');
    
    scoreText.textContent = `${results.accuracy}%`;
    
    // Update score circle color based on performance
    scoreCircle.className = 'score-circle';
    if (results.accuracy === 100) {
        scoreCircle.classList.add('excellent');
        performanceTitle.textContent = 'Perfect Score! üéâ';
        performanceMessage.textContent = 'Outstanding! You got every question right!';
    } else if (results.accuracy >= 90) {
        scoreCircle.classList.add('excellent');
        performanceTitle.textContent = 'Excellent! üåü';
        performanceMessage.textContent = 'Amazing performance! You\'re a quiz master!';
    } else if (results.accuracy >= 70) {
        scoreCircle.classList.add('good');
        performanceTitle.textContent = 'Great Job! üëè';
        performanceMessage.textContent = 'Well done! You did really well!';
    } else if (results.accuracy >= 50) {
        scoreCircle.classList.add('average');
        performanceTitle.textContent = 'Good Effort! üí™';
        performanceMessage.textContent = 'Nice try! Keep practicing to improve!';
    } else {
        scoreCircle.classList.add('poor');
        performanceTitle.textContent = 'Keep Trying! üìö';
        performanceMessage.textContent = 'Don\'t give up! Practice makes perfect!';
    }
    
    // Update stats
    document.getElementById('correctCount').textContent = results.correct;
    document.getElementById('wrongCount').textContent = results.wrong;
    document.getElementById('timeTaken').textContent = `${results.time}s`;
    document.getElementById('streakCount').textContent = results.streak;
}

function checkAchievements() {
    const achievementGrid = document.getElementById('achievementGrid');
    achievementGrid.innerHTML = '';
    
    achievements.forEach(achievement => {
        const isUnlocked = achievement.condition(results);
        const badge = document.createElement('div');
        badge.className = `achievement-badge ${isUnlocked ? 'unlocked' : 'locked'}`;
        badge.innerHTML = achievement.icon;
        badge.title = achievement.name;
        
        if (isUnlocked) {
            badge.onclick = () => showAchievementDetails(achievement);
        }
        
        achievementGrid.appendChild(badge);
    });
}

function showAchievementDetails(achievement) {
    // Create a simple notification for achievement details
    const notification = document.createElement('div');
    notification.className = 'alert alert-success position-fixed top-0 start-50 translate-middle-x mt-3';
    notification.style.zIndex = '9999';
    notification.innerHTML = `
        <strong>${achievement.icon} ${achievement.name}</strong><br>
        <small>Achievement Unlocked!</small>
    `;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

function loadLeaderboard() {
    const leaderboardBody = document.getElementById('leaderboardBody');
    const scores = JSON.parse(localStorage.getItem('quizScores') || '[]');
    
    // Sort scores by accuracy and then by time
    scores.sort((a, b) => {
        if (b.percentage !== a.percentage) {
            return b.percentage - a.percentage;
        }
        return a.time - b.time;
    });
    
    // Get top 5 scores
    const topScores = scores.slice(0, 5);
    
    leaderboardBody.innerHTML = '';
    topScores.forEach((score, index) => {
        const row = document.createElement('tr');
        const rankClass = index < 3 ? `rank-${index + 1}` : '';
        
        row.innerHTML = `
            <td>
                <span class="rank-medal ${rankClass}">${index + 1}</span>
            </td>
            <td>${score.username}</td>
            <td>${score.score}/${score.total}</td>
            <td>${score.percentage}%</td>
            <td>${score.time}s</td>
        `;
        
        leaderboardBody.appendChild(row);
    });
    
    // If no scores, show placeholder
    if (topScores.length === 0) {
        leaderboardBody.innerHTML = `
            <tr>
                <td colspan="5" class="text-center">No scores yet. Be the first!</td>
            </tr>
        `;
    }
}

function createConfetti() {
    if (results.accuracy >= 90) {
        const container = document.getElementById('confettiContainer');
        const colors = ['#00f2ff', '#FFD700', '#4caf50', '#ff9800', '#f44336'];
        
        for (let i = 0; i < 50; i++) {
            setTimeout(() => {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                container.appendChild(confetti);
                
                setTimeout(() => confetti.remove(), 5000);
            }, i * 100);
        }
    }
}

function animateCharts() {
    setTimeout(() => {
        document.getElementById('accuracyBar').style.width = `${results.accuracy}%`;
        document.getElementById('accuracyValue').textContent = `${results.accuracy}%`;
        
        document.getElementById('speedBar').style.width = `${results.speedScore}%`;
        document.getElementById('speedValue').textContent = `${results.speedScore}%`;
        
        document.getElementById('consistencyBar').style.width = `${results.consistencyScore}%`;
        document.getElementById('consistencyValue').textContent = `${results.consistencyScore}%`;
    }, 500);
}

// Action Functions
function downloadCertificate() {
    // Create certificate content
    const certificateContent = `
        <div style="text-align: center; padding: 50px; font-family: Arial;">
            <h1 style="color: #FFD700;">Certificate of Achievement</h1>
            <p>This is to certify that</p>
            <h2>${results.username}</h2>
            <p>has successfully completed the QuizVerse challenge</p>
            <h3>Score: ${results.score}/${results.total} (${results.accuracy}%)</h3>
            <p>Difficulty: ${results.difficulty.charAt(0).toUpperCase() + results.difficulty.slice(1)}</p>
            <p>Time: ${results.time} seconds</p>
            <p>Date: ${new Date().toLocaleDateString()}</p>
        </div>
    `;
    
    // Create and download certificate
    const blob = new Blob([certificateContent], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `QuizVerse_Certificate_${results.username}_${Date.now()}.html`;
    a.click();
    URL.revokeObjectURL(url);
    
    showNotification('Certificate downloaded successfully!', 'success');
}

function reviewAnswers() {
    // Store results for review page
    localStorage.setItem('reviewResults', JSON.stringify(results));
    window.location.href = 'review.html';
}

function playAgain() {
    window.location.href = 'home.html';
}

function shareOnTwitter() {
    const text = `I scored ${results.score}/${results.total} (${results.accuracy}%) on QuizVerse! üéØ Can you beat my score?`;
    const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
    window.open(url, '_blank');
}

function shareOnFacebook() {
    const url = window.location.href;
    const fbUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
    window.open(fbUrl, '_blank');
}

function copyLink() {
    const text = `I scored ${results.score}/${results.total} (${results.accuracy}%) on QuizVerse! üéØ`;
    navigator.clipboard.writeText(text).then(() => {
        showNotification('Link copied to clipboard!', 'success');
    });
}

function downloadResults() {
    const resultsData = {
        username: results.username,
        score: results.score,
        total: results.total,
        accuracy: results.accuracy,
        time: results.time,
        difficulty: results.difficulty,
        date: new Date().toISOString()
    };
    
    const blob = new Blob([JSON.stringify(resultsData, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `QuizVerse_Results_${results.username}_${Date.now()}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    showNotification('Results downloaded successfully!', 'success');
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type} position-fixed top-0 start-50 translate-middle-x mt-3`;
    notification.style.zIndex = '9999';
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}

// Theme Management
function toggleTheme() {
    const body = document.body;
    const themeIcon = document.getElementById('themeIcon');
    
    if (body.classList.contains('light-theme')) {
        body.classList.remove('light-theme');
        themeIcon.className = 'bi bi-moon-fill';
        localStorage.setItem('theme', 'dark');
    } else {
        body.classList.add('light-theme');
        themeIcon.className = 'bi bi-sun-fill';
        localStorage.setItem('theme', 'light');
    }
}

function loadTheme() {
    const theme = localStorage.getItem('theme') || 'dark';
    const themeIcon = document.getElementById('themeIcon');
    
    if (theme === 'light') {
        document.body.classList.add('light-theme');
        themeIcon.className = 'bi bi-sun-fill';
    } else {
        themeIcon.className = 'bi bi-moon-fill';
    }
}
</script>

</body>
</html>
